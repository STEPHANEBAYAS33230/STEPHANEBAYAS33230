<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>STATION METEO</title>
    <script src="https://kit.fontawesome.com/aa652281aa.js" crossorigin="anonymous"></script>
    <!-- ^^fontansome -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css" integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ho+j7jyWK8fNQe+A12Hb8AhRq26LrZ/JpcUGGOn+Y7RsweNrtN/tE3MoK7ZeZDyx" crossorigin="anonymous"></script>
    <script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAIzIYvsimaI9JgAermjettJljdUCfqnsQ&callback=initMap"
    type="text/javascript"></script>
    <link rel="stylesheet" href="METEO.css">
    <link href="https://fonts.googleapis.com/css2?family=Aclonica&display=swap" rel="stylesheet"> 
</head>
<body>
    <input id="villes" type="text" value="" placeholder="saisissez votre ville(,fr(optionnel)) exemple: brest,fr (comme il existe plusieurs brest dans le monde)" />
    <div class="villelong">
    <div id="nomdeville"></div>
    <div id="lonlat"></div>
    <div id="dater"></div>    
    </div>
    <div class="villelong">
    <div id="temperature"></div>
    <div id="temperature2">connexion en cours</div>
    </div>
    <div class="villelong">
    <div id="ciel"></div>
    </div>
    <div class="villelong">
    <div id="vent"></div>
    <div id="humidite"></div>
    <div id="coucheleve"></div>
    </div>
    <div class="villelong">
    <div class="mapouter"><div class="gmap_canvas" id="maper"></div>
    </div>
    <script>
        
        var requeteApi = "http://api.openweathermap.org/data/2.5/weather?q=";
        var keyt = "&units=metric&lang=fr&appid=b7229e3f046944cc7010b605a863de72";
        var requeteapi2;
        var element;
        var town="";
        var oldTown="xxx2";
        var requete;
        var requete2;
        var elm;
        var town;
        var idlat;
        var idlon;
        var x;
        var ressenti;
        var longlat;
        var ciel;
        var icone;
        var map;
        setInterval(function() {
            eure();
        }, 1000);
        setInterval(function() {
            bouton();
        }, 6000);

        function eure() {
            var jour = new Date();
            element = document.getElementById("dater");
            element.innerHTML = '<i class="far fa-calendar-alt"></i>'+(jour.getDate().toString()) + "/" + ((jour.getMonth() + 1).toString()) + "/" + (jour.getFullYear().toString()) + '<br><i class="far fa-clock"></i>' + (jour.getHours().toString()) + "h" + (jour.getMinutes().toString()) + "min" + (jour.getSeconds().toString()) + "seconde(s)";
        }



        var callBacksucess = function(data) {
           // (data.weather[0].icon)
            icone='<img src="http://openweathermap.org/img/wn/'+(data.weather[0].icon)+'@2x.png">';
           
            idlon=(data.coord.lon);
            idlat=(data.coord.lat);
            
            element = document.getElementById("nomdeville");
            element.innerHTML = '<i class="fas fa-city"></i>'+(data.name.toString().toUpperCase()) + " (" + (data.sys.country.toString().toUpperCase()) + ")";
             //long et lat
            element = document.getElementById("lonlat");
            longlat = "longitude:" + (((data.coord.lon).toFixed(2)).toString()) + '<br>lattitude:' + (((data.coord.lat).toFixed(2)).toString());
            element.innerHTML = longlat;
            // requete 2
            bouton2();
          
            //temperature
            element = document.getElementById("temperature");
            x = (data.main.temp - 273);
            element.innerHTML='<i class="fas fa-temperature-high"></i>'+(((data.main.temp).toFixed(1)).toString()) + "°c";
            element = document.getElementById("temperature2");
            element.innerHTML="température min:" + (((data.main.temp_min).toFixed(1)).toString()) + "°c<br> température max:" + (((data.main.temp_max).toFixed(1)).toString()) + "°c<br>"+ressenti;
            
            element = document.getElementById("ciel");
            element.innerHTML = icone+"météo du jour<br>"+(data.weather[0].description)+'<br><i class="fab fa-cloudflare"></i>nuage: ' + (data.clouds.all).toString() + "% ";
            //humidité pression
            element = document.getElementById("humidite");
            element.innerHTML= '<i class="fas fa-tint"></i>'+"Taux Humidité:"+ (data.main.humidity.toString().toUpperCase()) + "%<br>Pression atmosphérique:" + (data.main.pressure.toString().toUpperCase());
            //vent
            element = document.getElementById("vent");
            element.innerHTML = "<i class='fas fa-wind'></i>Vent:" + (((data.wind.speed) * 1.6).toFixed(1).toString()) + "km/heure Degrés:" + ((data.wind.deg).toString());
            // couche leve
            element = document.getElementById("coucheleve");
            var coucher=new Date(((data.sys.sunset)*1000)).toString();
            var leve=new Date(((data.sys.sunrise)*1000)).toString();
            element.innerHTML ='<i class="fas fa-sun"></i>Levée du jour: '+leve.substr(16,8)+' <i class="fas fa-moon"></i>Coucher du soleil: '+coucher.substr(16,8);
        }
        function bouton() {
            town = (document.getElementById("villes").value);
            //***********************googlemap
            if (town!=oldTown) {
            (document.getElementById("maper")).innerHTML='<iframe width="100%" height="500" id="gmap_canvas" src="https://maps.google.com/maps?q='+town+'&t=&z=13&ie=UTF8&iwloc=&output=embed" frameborder="0" scrolling="no" marginheight="0" marginwidth="0"></iframe><a href="https://123movies-to.org">123movies unblocked site</a></div><style>.mapouter{position:relative;text-align:right;height:500px;width:600px;}.gmap_canvas {overflow:hidden;background:none!important;height:500px;width:600px;}</style>';
            oldTown=town;
            }
            requete = requeteApi + town.toLowerCase() + keyt;
            $.getJSON(requete, callBacksucess).done(function() {

                })
                .fail(function() { element = document.getElementById("temperature2");
        elm = "erreur de saisie ou station météo non présente sur cette localisation (choisir une ville plus importante)";
        element.innerHTML = elm;
                })
                .always(function() {
                   
                })
        }
        function bouton2() {
requeteapi2="http://api.openweathermap.org/data/2.5/weather?lat="+idlat.toString()+"&lon="+idlon.toString();
requete2 = requeteapi2+keyt;
$.getJSON(requete2, callBacksucess2).done(function() {

    })
    .fail(function() {
        element = document.getElementById("temperature2");
        elm = "erreur de saisie ou station météo non présente sur cette localisation (choisir une ville plus importante)";
        element.innerHTML = elm;
    })
    .always(function() {
       
    })
}
var callBacksucess2 = function(data2) {
            ressenti= "température ressentie: " + (data2.main.feels_like);
        }
   
    </script>
</body>

</html>
